#!/bin/bash

# Function to get the current default sink volume percentage
getPercentage() {
    pactl list sinks |  grep -o "[0-9]*%" | head -n 1 | tr -d "%"
}

isMuted() {
    pactl list sinks | grep Mute | tr -d "Mute:\t" | sed -E "s/ +ys/true/g" | sed -E "s/ +no/false/g"
}

# Get the current volume percentage
current_volume=$(getPercentage)
is_muted=$(isMuted)

# Update the notification with the current volume percentage
if [ "$is_muted" = true ]; then 
    icon="audio-volume-muted-symbolic"
elif [ "$current_volume" -gt 65 ]; then
    icon="audio-volume-high-symbolic"
elif [ "$current_volume" -gt 30 ]; then
    icon="audio-volume-medium-symbolic"
elif [ "$current_volume" -gt 0 ]; then
    icon="audio-volume-low-symbolic"
elif [ "$current_volume" -eq 0 ]; then
    icon="audio-volume-muted-symbolic"
fi
muted_text=`[ "$is_muted" = true ] && echo Muted`
notify-send "Volume" $muted_text -t 2000 -h int:value:$current_volume  -h string:synchronous:"volume" --icon=$icon  --action="default,'pavucontrol'"
